const documentsConfig = [
  {
    name: "general-information",
    category: "Загальна інформація",
    documents: [
      {
        title: "Публічна інформація ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Публічна_інформація_ТОВ_ФАКТОРИНГ_ПАРТНЕРС_(3).pdf",
      },
      {
        title:
          "Свідоцтво фінансової установи №13103917 від 21.02.2019 р. щодо ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Свідоцтво фінансової установи №13103917 від 21.02.2019 р. щодо ТОВ ФАКТОРИНГ ПАРТНЕРС.pdf",
      },
      {
        title:
          "Розпорядження Нацкомфінпослуг №242 від 21.02.2019 р. про видачу Свідоцтва фінустанови",
        src: "Розпорядження Нацкомфінпослуг №242 від 21.02.2019 р. про видачу Свідоцтва фінустанови.pdf",
      },
      {
        title:
          "Чинна ліцензія: НА ДІЯЛЬНІСТЬ ФІНАНСОВОЇ КОМПАНІЇ З ПРАВОМ НАДАННЯ ПОСЛУГ – ФАКТОРИНГ, НАДАННЯ КОШТІВ ТА БАНКІВСЬКИХ МЕТАЛІВ У КРЕДИТ (ВИТЯГ із Державного реєстру фінансових установ від 20.03.2024)",
        src: "Витяг_із_Державного_реєстру_фінансових_установ.pdf",
      },
      {
        title: "Свідоцтво на торговельну марку FP FACTORING PARTNERS",
        src: "Свідоцтво_на_торговельну_марку_ФП.pdf",
      },
      {
        title:
          "Інформація щодо врегулювання простроченої заборгованості ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Інформація_щодо_врегулювання_простроченої_заборгованості.pdf",
      },
      {
        title:
          "Інформація щодо обробки та захисту персональних даних ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Інформація_щодо_обробки_та_захисту_персональних_даних.pdf",
      },
      {
        title:
          "Контактні дані ТОВ ФАКТОРИНГ ПАРТНЕРС за якими приймаються звернення споживачів фінансових послуг щодо діяльності залучених колекторських компаній",
        src: "Контактні_дані_ТОВ_ФАКТОРИНГ_ПАРТНЕРС_за_якими_приймаються_звернення.pdf",
      },
    ],
  },
  {
    name: "financial-services",
    category: "Фінансові послуги",
    documents: [
      {
        title: "Тарифи на послуги",
        src: "Тарифи на послуги.pdf",
      },
      {
        title: "Умови кредитування юридичних осіб",
        src: "УМОВИ_КРЕДИТУВАННЯ_ЮРИДИЧНИХ_ОСІБ.pdf",
      },
      {
        title:
          "Правила надання коштів в кредит юридичним особам (діють з 28.04.2025)",
        src: "ПРАВИЛА_НАДАННЯ_КОШТІВ_ЮРИДИЧНИМ_ОСОБАМ_діють_з_28_04_2025.pdf",
      },
      {
        title: "Правила надання послуг з факторингу (діють з 19.04.2024)",
        src: "Правила_надання_послуг_з_факторингу_діють_з_19_04_2024.pdf",
      },
      {
        title:
          "Примірний договір надання коштів в кредит юридичним особам (діє з 28.04.2024)",
        src: "ПРИМІРНИЙ_ДОГОВІР_НАДАННЯ_КОШТІВ_В_КРЕДИТ_ЮРИДИЧНИМ_ОСОБАМ_діє_з.pdf",
      },
      {
        title:
          "Примірний договір надання послуг з факторингу (діє з 19.04.2024)",
        src: "Примірний_договір_надання_послуг_з_факторингу_діє_з_19_04_2024.pdf",
      },
    ],
  },
  {
    name: "internal-procedures",
    category: "Внутрішні положення",
    documents: [
      {
        title: "Вимоги до етичної поведінки ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Вимоги щодо етичної поведінки.pdf",
      },
      {
        title:
          "Порядок розгляду звернень споживачів послуг ТОВ ФАКТОРИНГ ПАРТНЕРС та інших осіб",
        src: "Порядок розгляду звернень.pdf",
      },
      {
        title:
          "Порядок обробки і захисту персональних даних у ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Порядок_обробки_і_захисту_персональних_даних.pdf",
      },
      {
        title:
          "Порядок використання електронного підпису та електронної печатки",
        src: "Порядок_використання_електронного_підпису_та_електронної_печатки.PDF",
      },
    ],
  },
  {
    name: "ownership-structure",
    category: "Структура власності",
    documents: [
      {
        title:
          "Відомості про структуру власності ТОВ ФАКТОРИНГ ПАРТНЕРС станом на 01.01.2025",
        src: "Відомості_про_структуру_власності_ТОВ_ФАКТОРИНГ_ПАРТНЕРС_станом на 01.01.2025.pdf",
      },
      {
        title:
          "Відомості про структуру власності ТОВ ФАКТОРИНГ ПАРТНЕРС станом на 01.01.2024",
        src: "Відомості_про_структуру_власності_ТОВ_ФАКТОРИНГ_ПАРТНЕРС_станом на 01.01.2024.pdf",
      },
      {
        title:
          "Відомості про структуру власності ТОВ ФАКТОРИНГ ПАРТНЕРС станом на 05.12.2023",
        src: "Відомості_про_структуру_власності_ТОВ_ФАКТОРИНГ_ПАРТНЕРС_станом на 05.12.2023.pdf",
      },
      {
        title: "Структура власності ТОВ ФАКТОРИНГ ПАРТНЕРС на 11.06.2021",
        src: "https://drive.google.com/file/d/1sOsR75DFEzPt2Svf6Z7rS17Wc92QwyzS/preview",
      },
    ],
  },
  {
    name: "financial-statements",
    category: "Фінансова звітність",
    documents: [
      {
        title:
          "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2024 рік з висновком аудитора.",
        src: "42640371_ЗНА ФАКТОРИНГ ПАРТЕРС 2024 V.2.pdf",
      },
      {
        title:
          "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2023 рік з висновком аудитора.",
        src: "42640371_ЗНА ФАКТОРИНГ ПАРТЕРС 2023 V.2.pdf",
      },
      {
        title:
          "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2022 рік з висновком аудитора.",
        src: "https://drive.google.com/file/d/1ydJo6wf4nRqFbKesHDNvEpPejVcp4LbJ/preview",
      },
      {
        title:
          "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2021 рік з висновком аудитора",
        src: "звітність 2021.pdf",
      },
      {
        title:
          "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2020 рік з висновком аудитора",
        src: "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2020 рік з висновком аудитора.pdf",
      },
      {
        title:
          "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2019 рік з висновком аудитора",
        src: "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2019 рік з висновком аудитора.pdf",
      },
      {
        title:
          "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2018 рік з висновком аудитора",
        src: "Річна фінансова звітність ТОВ ФАКТОРИНГ ПАРТНЕРС за 2018 рік з висновком аудитора.pdf",
      },
    ],
  },
  {
    name: "archive",
    category: "Архів",
    documents: [
      {
        title:
          "Розпорядження Нацкомфінпослуг №368 від 14.03.2019р. про видачу ліцензій (діяло до 20.03.2024)",
        src: "Розпорядження Нацкомфінпослуг №368 від 14.03.2019р. про видачу ліцензій.pdf",
      },
      {
        title:
          "Правила надання послуг з факторингу діяли з 17.01.2020 р (втратили чиність)",
        src: "Правила надання послуг з факторингу діяли з 17.01.2020 р (втратили чиність).pdf",
      },
      {
        title:
          "Правила над. коштів у позику (діяли з 27.10.2022 р. втратили чинність)",
        src: "Правила над. коштів у позику (діють з 27.10.2022 р.).pdf",
      },
      {
        title:
          "Правила над. коштів у позику діяли з 23.08.2022 р втратили чинність",
        src: "Правила над. коштів у позику діяли з 23.08.2022 р втратили чинність.pdf",
      },
      {
        title:
          "Примірний договір про надання коштів у позику (діяв з 23.08.2022 р. втратив чинність)",
        src: "Примірний договір про надання коштів у позику, в тому числі і на умовах фінансового кредиту (діє з 23.08.2022 р.).pdf",
      },
      {
        title:
          "Правила надання коштів у позику, в тому числі і на умовах фінансового кредиту, які діяли до 14.07.2021 (втратили чинність)",
        src: "Правила надання коштів у позику, в тому числі і на умовах фінансового кредиту, які діяли до 14.07.2021 (втратили чинність).pdf",
      },
      {
        title:
          "Правила надання споживчих кредитів ТОВ ФАКТОРИНГ ПАРТНЕРС діяли з 13.07.2021 р. (втратили чинність)",
        src: "Правила надання споживчих кредитів ТОВ ФАКТОРИНГ ПАРТНЕРС діяли з 13.07.2021 р. (втратили чинність).pdf",
      },
      {
        title:
          "Примірний договір факторингу діяв з 23.01.2020 р. до 27.10.2021 р. (втратив чинність)",
        src: "Примірний договір факторингу діяв з 23.01.2020 р. до 27.10.2021 р. (втратив чинність).pdf",
      },
      {
        title:
          "Примірний договір про надання коштів у позику, в тому числі і на умовах фінансового кредиту діяв з 23.01.2020 р. (втратив чинність)",
        src: "Примірний договір про надання коштів у позику, в тому числі і на умовах фінансового кредиту діяв з 23.01.2020 р. (втратив чинність).pdf",
      },
      {
        title:
          "Примірний Договір про надання споживчого кредиту діяв з 19.08.2021 р. (втратив чинність)",
        src: "Примірний Договір про надання споживчого кредиту діяв з 19.08.2021 р. (втратив чинність).pdf",
      },
      {
        title:
          "Паспорт споживчого кредиту діяв з 06.01.2022 р. по 22.08.2022 р. (втратив чинність)",
        src: "Паспорт споживчого кредиту діяв з 06.01.2022 р. по 22.08.2022 р. (втратив чинність).pdf",
      },
      {
        title:
          "Примірний Договір кредитний договір від 05.01.2022 по 22.08.2022 р. (втратив чинність)",
        src: "Примірний Договір кредитний договір від 05.01.2022 по 22.08.2022 р. (втратив чинність).pdf",
      },
      {
        title:
          "Правила надання споживчих кредитів діяли з 06.01.2022 р. по 22.08.2022 р. (втратили чинність)",
        src: "Правила надання споживчих кредитів діяли з 06.01.2022 р. по 22.08.2022 р. (втратили чинність).pdf",
      },
      {
        title:
          "Примірний Договір про надання споживчого кредиту діяв з 13.07.2021 р. (втратив чинність)",
        src: "Примірний Договір про надання споживчого кредиту діяв з 13.07.2021 р. (втратив чинність).pdf",
      },
      {
        title:
          "Примірний договір кредитної лінії для юридичних осіб (діяв з 08.11.2022 по 18.04.2024)",
        src: "Примірний договір кредитної лінії для юридичних осіб діють з 08.11.2022 р..pdf",
      },
      {
        title:
          "Правила кредитної лінії для юридичних осіб (діяли з 08.11.2022 по 18.04.2024)",
        src: "Правила кредитної лінії для юридичних осіб діють з 08.11.2022 р..pdf",
      },
      {
        title:
          "Правила надання послуг з факторингу (діяли з 08.11.2022 по 18.04.2024)",
        src: "Правила надання послуг з факторингу (діють з 27.10.2022 р.).pdf",
      },
      {
        title: "Примірний договір факторингу (діяв з 08.11.2022 по 18.04.2024)",
        src: "Примірний договір факторингу (діє з 27.10.2021 р.).pdf",
      },
      {
        title:
          "Правила надання коштів в кредит юридичним особам (діють з 19.04.2024)",
        src: "Правила_надання_коштів_в_кредит_юридичним_особам_діють_з_19_04_2024.pdf",
      },
      {
        title: "Вимоги до етичної поведінки ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Вимоги до етичної поведінки ТОВ ФАКТОРИНГ ПАРТНЕРС.pdf",
      },
      {
        title:
          "Порядок розгляду звернень споживачів послуг ТОВ ФАКТОРИНГ ПАРТНЕРС та інших осіб",
        src: "Порядок розгляду звернень споживачів послуг ТОВ ФАКТОРИНГ ПАРТНЕРС та інших осіб.pdf",
      },
      {
        title:
          "Порядок обробки і захисту персональних даних у ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "https://drive.google.com/file/d/1f1ciLtPHMgLxXaXf9_ddwnW2MeqivHTJ/preview",
      },
      {
        title:
          "Положення про конфіденційність для користувачів сайту ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Положення про конфіденційність для користувачів сайту ТОВ ФАКТОРИНГ ПАРТНЕРС.pdf",
      },
      {
        title:
          "Порядок повідомлення про представника споживача ТОВ ФАКТОРИНГ ПАРТНЕРС",
        src: "Порядок повідомлення про представника споживача ТОВ ФАКТОРИНГ ПАРТНЕРС.pdf",
      },
      {
        title: "Умови кредитування юридичних осіб",
        src: "Умови_кредитування_юридичних_осіб.pdf",
      },
      {
        title:
          "Правила надання коштів в кредит юридичним особам (діють з 12.02.2025)",
        src: "Правила надання коштів у кредит.pdf",
      },
      {
        title:
          "Примірний договір надання коштів в кредит юридичним особам (діє з 19.04.2024)",
        src: "Примірний_договір_надання_коштів_в_кредит_юридичним_особам_діє_з.pdf",
      },
    ],
  },
];

const DOCUMENTS_PATH = "docs";

function renderDocumentsPage() {
  const documentsContent = document.querySelector(".documents__content");

  documentsContent.innerHTML = documentsConfig
    .map((category) => {
      const categotyName = category.name;
      const documentsHtml = category.documents
        .map((doc, docIndex) => {
          const documentSrc = `${DOCUMENTS_PATH}/${categotyName}/${doc?.src || ""}`;
          return `
              <li class="document__item">
                <button
                  class="document__accordion"
                  data-document-button
                  data-category-index="${categotyName}"
                  data-document-index="${docIndex}"
                  data-document-src="${documentSrc}"
                >
                  ${doc.title}
                </button>
                <div class="document__iframe-wrapper" data-document-wrapper></div>
              </li>
            `;
        })
        .join("");

      return `
          <div class="documents__item">
            <button class="documents__accordion" data-category-button>
              ${category.category}
            </button>
            <ul class="documents__list" data-category-list>
              ${documentsHtml}
            </ul>
          </div>
        `;
    })
    .join("");

  documentsContent
    .querySelectorAll("[data-category-button]")
    .forEach((button) => {
      button.addEventListener("click", function () {
        this.classList.toggle("documents__accordion--active");
        const list = this.nextElementSibling;
        if (list) {
          list.classList.toggle("documents__list--active");
        }
      });
    });

  const handleDocumentClick = (event) => {
    const button = event.currentTarget;
    const wrapper = button.nextElementSibling;
    if (!wrapper || !wrapper.hasAttribute("data-document-wrapper")) {
      return;
    }

    button.classList.toggle("document__accordion--active");
    const isOpening = wrapper.classList.toggle(
      "document__iframe-wrapper--active"
    );

    if (isOpening) {
      if (wrapper.querySelector("iframe")) {
        return;
      }

      const rawSrc = button.getAttribute("data-document-src");
      if (!rawSrc) {
        return;
      }

      const iframeSrc = encodeURI(rawSrc);

      const iframe = document.createElement("iframe");
      iframe.className = "document__iframe";
      iframe.loading = "lazy";
      iframe.title = button.textContent || "";
      iframe.src = iframeSrc;
      wrapper.appendChild(iframe);
      return;
    }

    const iframe = wrapper.querySelector("iframe");
    if (iframe) {
      iframe.remove();
    }
  };

  documentsContent
    .querySelectorAll("[data-document-button]")
    .forEach((button) => button.addEventListener("click", handleDocumentClick));
}

window.renderDocumentsPage = renderDocumentsPage;
